<header>
  <h1>Introduction</h1>
</header>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="what-socketio-is">What Socket.IO is<a href="#what-socketio-is"
    class="hash-link" aria-label="Direct link to What Socket.IO is" title="Direct link to What Socket.IO is">​</a></h2>
<p>Socket.IO is a library that enables <strong>low-latency</strong>, <strong>bidirectional</strong> and
  <strong>event-based</strong> communication between a client and a server.</p><img
  src="/images/bidirectional-communication2.png" alt="Diagram of a communication between a server and a client"
  class="themedImage_ToTc themedImage--light_HNdA">
<p>It is built on top of the <a href="https://en.wikipedia.org/wiki/WebSocket" target="_blank"
    rel="noopener noreferrer">WebSocket</a> protocol and provides additional guarantees like fallback to HTTP
  long-polling or automatic reconnection.</p>
<div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9">
  <div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16">
        <path fill-rule="evenodd"
          d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z">
        </path>
      </svg></span>info</div>
  <div class="admonitionContent_S0QG">
    <p>WebSocket is a communication protocol which provides a full-duplex and low-latency channel between the server and
      the browser. More information can be found <a href="https://en.wikipedia.org/wiki/WebSocket" target="_blank"
        rel="noopener noreferrer">here</a>.</p>
  </div>
</div>
<p>There are several Socket.IO server implementations available:</p>
<ul class="">
  <li>JavaScript (Node.js) (whose documentation can be found here on this website)<ul class="">
      <li><a href="/docs/v4/server-installation/">Installation steps</a></li>
      <li><a href="/docs/v4/server-api/">API</a></li>
      <li><a href="https://github.com/socketio/socket.io" target="_blank" rel="noopener noreferrer">Source code</a></li>
    </ul>
  </li>
  <li>JavaScript (Deno): <a href="https://github.com/socketio/socket.io-deno" target="_blank"
      rel="noopener noreferrer">https://github.com/socketio/socket.io-deno</a></li>
  <li>Java: <a href="https://github.com/mrniko/netty-socketio" target="_blank"
      rel="noopener noreferrer">https://github.com/mrniko/netty-socketio</a></li>
  <li>Java: <a href="https://github.com/trinopoty/socket.io-server-java" target="_blank"
      rel="noopener noreferrer">https://github.com/trinopoty/socket.io-server-java</a></li>
  <li>Python: <a href="https://github.com/miguelgrinberg/python-socketio" target="_blank"
      rel="noopener noreferrer">https://github.com/miguelgrinberg/python-socketio</a></li>
  <li>Golang: <a href="https://github.com/googollee/go-socket.io" target="_blank"
      rel="noopener noreferrer">https://github.com/googollee/go-socket.io</a></li>
</ul>
<p>And client implementations in most major languages:</p>
<ul class="">
  <li>JavaScript (which can be run either in the browser, in Node.js or in React Native)<ul class="">
      <li><a href="/docs/v4/client-installation/">Installation steps</a></li>
      <li><a href="/docs/v4/client-api/">API</a></li>
      <li><a href="https://github.com/socketio/socket.io-client" target="_blank" rel="noopener noreferrer">Source
          code</a></li>
    </ul>
  </li>
  <li>JavaScript (for WeChat Mini-Programs): <a href="https://github.com/weapp-socketio/weapp.socket.io" target="_blank"
      rel="noopener noreferrer">https://github.com/weapp-socketio/weapp.socket.io</a></li>
  <li>Java: <a href="https://github.com/socketio/socket.io-client-java" target="_blank"
      rel="noopener noreferrer">https://github.com/socketio/socket.io-client-java</a></li>
  <li>C++: <a href="https://github.com/socketio/socket.io-client-cpp" target="_blank"
      rel="noopener noreferrer">https://github.com/socketio/socket.io-client-cpp</a></li>
  <li>Swift: <a href="https://github.com/socketio/socket.io-client-swift" target="_blank"
      rel="noopener noreferrer">https://github.com/socketio/socket.io-client-swift</a></li>
  <li>Dart: <a href="https://github.com/rikulo/socket.io-client-dart" target="_blank"
      rel="noopener noreferrer">https://github.com/rikulo/socket.io-client-dart</a></li>
  <li>Python: <a href="https://github.com/miguelgrinberg/python-socketio" target="_blank"
      rel="noopener noreferrer">https://github.com/miguelgrinberg/python-socketio</a></li>
  <li>.Net: <a href="https://github.com/doghappy/socket.io-client-csharp" target="_blank"
      rel="noopener noreferrer">https://github.com/doghappy/socket.io-client-csharp</a></li>
  <li>Rust: <a href="https://github.com/1c3t3a/rust-socketio" target="_blank"
      rel="noopener noreferrer">https://github.com/1c3t3a/rust-socketio</a></li>
  <li>Kotlin: <a href="https://github.com/icerockdev/moko-socket-io" target="_blank"
      rel="noopener noreferrer">https://github.com/icerockdev/moko-socket-io</a></li>
</ul>
<p>Here's a basic example with plain WebSockets:</p>
<p><em>Server</em> (based on <a href="https://github.com/websockets/ws" target="_blank"
    rel="noopener noreferrer">ws</a>)</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword module" style="color: rgb(0, 0, 159);">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">WebSocketServer</span><span class="token imports"> </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token keyword module" style="color: rgb(0, 0, 159);">from</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"ws"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> server </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">new</span><span class="token plain"> </span><span class="token class-name">WebSocketServer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"> </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">port</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">3000</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">server</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connection"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// send a message to the client</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">send</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">stringify</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">type</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"hello from server"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">content</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">[</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">1</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"2"</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// receive a message from the client</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"message"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">data</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> packet </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token known-class-name class-name">JSON</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">parse</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">data</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">switch</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">packet</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">type</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token keyword" style="color: rgb(0, 0, 159);">case</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"hello from client"</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">break</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p><em>Client</em></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> socket </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">new</span><span class="token plain"> </span><span class="token class-name">WebSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"ws://localhost:3000"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">addEventListener</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"open"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// send a message to the server</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">send</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">stringify</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">type</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"hello from client"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">content</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">[</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">3</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"4"</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// receive a message from the server</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">addEventListener</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"message"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token parameter"> data </span><span class="token parameter punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> packet </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token known-class-name class-name">JSON</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">parse</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">data</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">switch</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">packet</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">type</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(0, 0, 159);">case</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"hello from server"</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">break</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>And here's the same example with Socket.IO:</p>
<p><em>Server</em></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword module" style="color: rgb(0, 0, 159);">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Server</span><span class="token imports"> </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token keyword module" style="color: rgb(0, 0, 159);">from</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"socket.io"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> io </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">new</span><span class="token plain"> </span><span class="token class-name">Server</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token number" style="color: rgb(54, 172, 170);">3000</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connection"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// send a message to the client</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello from server"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">1</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"2"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">3</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token maybe-class-name">Buffer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token keyword module" style="color: rgb(0, 0, 159);">from</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">[</span><span class="token number" style="color: rgb(54, 172, 170);">4</span><span class="token punctuation" style="color: rgb(57, 58, 52);">]</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// receive a message from the client</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello from client"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter spread operator" style="color: rgb(57, 58, 52);">...</span><span class="token parameter">args</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p><em>Client</em></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword module" style="color: rgb(0, 0, 159);">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token imports"> io </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token keyword module" style="color: rgb(0, 0, 159);">from</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"socket.io-client"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> socket </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"ws://localhost:3000"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// send a message to the server</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello from client"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">5</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"6"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">7</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Uint8Array</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token keyword module" style="color: rgb(0, 0, 159);">from</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">[</span><span class="token number" style="color: rgb(54, 172, 170);">8</span><span class="token punctuation" style="color: rgb(57, 58, 52);">]</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// receive a message from the server</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello from server"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter spread operator" style="color: rgb(57, 58, 52);">...</span><span class="token parameter">args</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>Both examples looks really similar, but under the hood Socket.IO provides additional features that hide the
  complexity of running an application based on WebSockets in production. Those features are listed <a
    href="#features">below</a>.</p>
<p>But first, let's make it clear what Socket.IO is not.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="what-socketio-is-not">What Socket.IO is not<a
    href="#what-socketio-is-not" class="hash-link" aria-label="Direct link to What Socket.IO is not"
    title="Direct link to What Socket.IO is not">​</a></h2>
<div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9">
  <div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16">
        <path fill-rule="evenodd"
          d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z">
        </path>
      </svg></span>caution</div>
  <div class="admonitionContent_S0QG">
    <p>Socket.IO is <strong>NOT</strong> a WebSocket implementation.</p>
  </div>
</div>
<p>Although Socket.IO indeed uses WebSocket for transport when possible, it adds additional metadata to each packet.
  That is why a WebSocket client will not be able to successfully connect to a Socket.IO server, and a Socket.IO client
  will not be able to connect to a plain WebSocket server either.</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// WARNING: the client will NOT be able to connect!</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> socket </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"ws://echo.websocket.org"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>If you are looking for a plain WebSocket server, please take a look at <a href="https://github.com/websockets/ws"
    target="_blank" rel="noopener noreferrer">ws</a> or <a href="https://github.com/uNetworking/uWebSockets.js"
    target="_blank" rel="noopener noreferrer">µWebSockets.js</a>.</p>
<p>There are also <a href="https://github.com/nodejs/node/issues/19308" target="_blank"
    rel="noopener noreferrer">discussions</a> for including a WebSocket server in the Node.js core.</p>
<p>On the client-side, you might be interested in the <a href="https://github.com/nathanboktae/robust-websocket"
    target="_blank" rel="noopener noreferrer">robust-websocket</a> package.</p>
<div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9">
  <div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16">
        <path fill-rule="evenodd"
          d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z">
        </path>
      </svg></span>caution</div>
  <div class="admonitionContent_S0QG">
    <p>Socket.IO is not meant to be used in a background service for mobile applications.</p>
  </div>
</div>
<p>The Socket.IO library keeps an open TCP connection to the server, which may result in a high battery drain for your
  users. Please use a dedicated messaging platform like <a href="https://firebase.google.com/docs/cloud-messaging"
    target="_blank" rel="noopener noreferrer">FCM</a> for this use case.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="features">Features<a href="#features" class="hash-link"
    aria-label="Direct link to Features" title="Direct link to Features">​</a></h2>
<p>Here are the features provided by Socket.IO over plain WebSockets:</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="http-long-polling-fallback">HTTP long-polling fallback<a
    href="#http-long-polling-fallback" class="hash-link" aria-label="Direct link to HTTP long-polling fallback"
    title="Direct link to HTTP long-polling fallback">​</a></h3>
<p>The connection will fall back to HTTP long-polling in case the WebSocket connection cannot be established.</p>
<p>This feature was the #1 reason people used Socket.IO when the project was created more than ten years ago (!), as the
  browser support for WebSockets was still in its infancy.</p>
<p>Even if most browsers now support WebSockets (more than <a href="https://caniuse.com/mdn-api_websocket"
    target="_blank" rel="noopener noreferrer">97%</a>), it is still a great feature as we still receive reports from
  users that cannot establish a WebSocket connection because they are behind some misconfigured proxy.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="automatic-reconnection">Automatic reconnection<a
    href="#automatic-reconnection" class="hash-link" aria-label="Direct link to Automatic reconnection"
    title="Direct link to Automatic reconnection">​</a></h3>
<p>Under some particular conditions, the WebSocket connection between the server and the client can be interrupted with
  both sides being unaware of the broken state of the link.</p>
<p>That's why Socket.IO includes a heartbeat mechanism, which periodically checks the status of the connection.</p>
<p>And when the client eventually gets disconnected, it automatically reconnects with an exponential back-off delay, in
  order not to overwhelm the server.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="packet-buffering">Packet buffering<a href="#packet-buffering"
    class="hash-link" aria-label="Direct link to Packet buffering" title="Direct link to Packet buffering">​</a></h3>
<p>The packets are automatically buffered when the client is disconnected, and will be sent upon reconnection.</p>
<p>More information <a href="/docs/v4/client-offline-behavior/#buffered-events">here</a>.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="acknowledgements">Acknowledgements<a href="#acknowledgements"
    class="hash-link" aria-label="Direct link to Acknowledgements" title="Direct link to Acknowledgements">​</a></h3>
<p>Socket.IO provides a convenient way to send an event and receive a response:</p>
<p><em>Sender</em></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"world"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">response</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">log</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">response</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"> </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// "got it"</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p><em>Receiver</em></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">arg</span><span class="token parameter punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token parameter"> callback</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">log</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"> </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// "world"</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token function" style="color: rgb(215, 58, 73);">callback</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"got it"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>You can also add a timeout:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">timeout</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token number" style="color: rgb(54, 172, 170);">5000</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"world"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">err</span><span class="token parameter punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token parameter"> response</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">if</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">err</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// the other side did not acknowledge the event in the given delay</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">else</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">log</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">response</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"> </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// "got it"</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="broadcasting">Broadcasting<a href="#broadcasting"
    class="hash-link" aria-label="Direct link to Broadcasting" title="Direct link to Broadcasting">​</a></h3>
<p>On the server-side, you can send an event to <a href="/docs/v4/broadcasting-events/">all connected clients</a> or <a
    href="/docs/v4/rooms/">to a subset of clients</a>:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// to all connected clients</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// to all connected clients in the "news" room</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">to</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"news"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>This also works when <a href="/docs/v4/using-multiple-nodes/">scaling to multiple nodes</a>.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="multiplexing">Multiplexing<a href="#multiplexing"
    class="hash-link" aria-label="Direct link to Multiplexing" title="Direct link to Multiplexing">​</a></h3>
<p>Namespaces allow you to split the logic of your application over a single shared connection. This can be useful for
  example if you want to create an "admin" channel that only authorized users can join.</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connection"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// classic users</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">of</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"/admin"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connection"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// admin users</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>More on that <a href="/docs/v4/namespaces/">here</a>.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="common-questions">Common questions<a href="#common-questions"
    class="hash-link" aria-label="Direct link to Common questions" title="Direct link to Common questions">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="is-socketio-still-needed-today">Is Socket.IO still needed
  today?<a href="#is-socketio-still-needed-today" class="hash-link"
    aria-label="Direct link to Is Socket.IO still needed today?"
    title="Direct link to Is Socket.IO still needed today?">​</a></h3>
<p>That's a fair question, since WebSockets are supported <a href="https://caniuse.com/mdn-api_websocket"
    target="_blank" rel="noopener noreferrer">almost everywhere</a> now.</p>
<p>That being said, we believe that, if you use plain WebSockets for your application, you will eventually need to
  implement most of the features that are already included (and battle-tested) in Socket.IO, like <a
    href="#automatic-reconnection">reconnection</a>, <a href="#acknowledgements">acknowledgements</a> or <a
    href="#broadcasting">broadcasting</a>.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="what-is-the-overhead-of-the-socketio-protocol">What is the
  overhead of the Socket.IO protocol?<a href="#what-is-the-overhead-of-the-socketio-protocol" class="hash-link"
    aria-label="Direct link to What is the overhead of the Socket.IO protocol?"
    title="Direct link to What is the overhead of the Socket.IO protocol?">​</a></h3>
<p><code>socket.emit("hello", "world")</code> will be sent as a single WebSocket frame containing
  <code>42["hello","world"]</code> with:</p>
<ul class="">
  <li><code>4</code> being Engine.IO "message" packet type</li>
  <li><code>2</code> being Socket.IO "message" packet type</li>
  <li><code>["hello","world"]</code> being the <code>JSON.stringify()</code>-ed version of the arguments array</li>
</ul>
<p>So, a few additional bytes for each message, which can be further reduced by the usage of a <a
    href="/docs/v4/custom-parser/">custom parser</a>.</p>
<div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9">
  <div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16">
        <path fill-rule="evenodd"
          d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z">
        </path>
      </svg></span>info</div>
  <div class="admonitionContent_S0QG">
    <p>The size of the browser bundle itself is <a href="https://bundlephobia.com/package/socket.io-client"
        target="_blank" rel="noopener noreferrer"><code>10.4 kB</code></a> (minified and gzipped).</p>
  </div>
</div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="something-does-not-work-properly-please-help">Something does
  not work properly, please help?<a href="#something-does-not-work-properly-please-help" class="hash-link"
    aria-label="Direct link to Something does not work properly, please help?"
    title="Direct link to Something does not work properly, please help?">​</a></h3>
<p>Please check the <a href="/docs/v4/troubleshooting-connection-issues/">Troubleshooting guide</a>.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="next-steps">Next steps<a href="#next-steps" class="hash-link"
    aria-label="Direct link to Next steps" title="Direct link to Next steps">​</a></h2>
<ul class="">
  <li><a href="/get-started/chat">Get started example</a></li>
  <li><a href="/docs/v4/server-installation/">Server installation</a></li>
  <li><a href="/docs/v4/client-installation/">Client installation</a></li>
</ul>
<header>
  <h1>How it works</h1>
</header>
<p>The bidirectional channel between the Socket.IO server (Node.js) and the Socket.IO client (browser, Node.js, or <a
    href="/docs/v4/#what-socketio-is">another programming language</a>) is established with a <a
    href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket" target="_blank"
    rel="noopener noreferrer">WebSocket connection</a> whenever possible, and will use HTTP long-polling as fallback.
</p>
<p>The Socket.IO codebase is split into two distinct layers:</p>
<ul class="">
  <li>the low-level plumbing: what we call Engine.IO, the engine inside Socket.IO</li>
  <li>the high-level API: Socket.IO itself</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="engineio">Engine.IO<a href="#engineio" class="hash-link"
    aria-label="Direct link to Engine.IO" title="Direct link to Engine.IO">​</a></h2>
<p>Engine.IO is responsible for establishing the low-level connection between the server and the client. It handles:</p>
<ul class="">
  <li>the various <a href="#transports">transports</a> and the <a href="#upgrade-mechanism">upgrade mechanism</a></li>
  <li>the <a href="#disconnection-detection">disconnection detection</a></li>
</ul>
<p>A detailed version of the Engine.IO protocol can be found <a href="/docs/v4/engine-io-protocol/">here</a>.</p>
<p>The source code of the reference implementation (written in TypeScript) can be found here:</p>
<ul class="">
  <li>server: <a href="https://github.com/socketio/engine.io" target="_blank"
      rel="noopener noreferrer">https://github.com/socketio/engine.io</a></li>
  <li>client: <a href="https://github.com/socketio/engine.io-client" target="_blank"
      rel="noopener noreferrer">https://github.com/socketio/engine.io-client</a></li>
  <li>parser: <a href="https://github.com/socketio/engine.io-parser" target="_blank"
      rel="noopener noreferrer">https://github.com/socketio/engine.io-parser</a></li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="transports">Transports<a href="#transports" class="hash-link"
    aria-label="Direct link to Transports" title="Direct link to Transports">​</a></h3>
<p>There are currently two implemented transports:</p>
<ul class="">
  <li><a href="#http-long-polling">HTTP long-polling</a></li>
  <li><a href="#websocket">WebSocket</a></li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="http-long-polling">HTTP long-polling<a
    href="#http-long-polling" class="hash-link" aria-label="Direct link to HTTP long-polling"
    title="Direct link to HTTP long-polling">​</a></h4>
<p>The HTTP long-polling transport (also simply referred as "polling") consists of successive HTTP requests:</p>
<ul class="">
  <li>long-running <code>GET</code> requests, for receiving data from the server</li>
  <li>short-running <code>POST</code> requests, for sending data to the server</li>
</ul>
<p>Due to the nature of the transport, successive emits may be concatenated and sent within the same HTTP request.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="websocket">WebSocket<a href="#websocket" class="hash-link"
    aria-label="Direct link to WebSocket" title="Direct link to WebSocket">​</a></h4>
<p>The WebSocket transport consists, well, of a <a
    href="https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API" target="_blank"
    rel="noopener noreferrer">WebSocket connection</a>, which provides a bidirectional and low-latency communication
  channel between the server and the client.</p>
<p>Due to the nature of the transport, each emit is sent in its own WebSocket frame (some emits may even result in two
  distinct WebSocket frames, more information <a href="/docs/v4/custom-parser/#the-default-parser">here</a>).</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="handshake">Handshake<a href="#handshake" class="hash-link"
    aria-label="Direct link to Handshake" title="Direct link to Handshake">​</a></h3>
<p>At the beginning of the Engine.IO connection, the server sends some information:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token property" style="color: rgb(54, 172, 170);">"sid"</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"FSDjX-WRwSA4zTZMALqx"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token property" style="color: rgb(54, 172, 170);">"upgrades"</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">[</span><span class="token string" style="color: rgb(227, 17, 108);">"websocket"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">]</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token property" style="color: rgb(54, 172, 170);">"pingInterval"</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">25000</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token property" style="color: rgb(54, 172, 170);">"pingTimeout"</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">20000</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<ul class="">
  <li>the <code>sid</code> is the ID of the session, it must be included in the <code>sid</code> query parameter in all
    subsequent HTTP requests</li>
  <li>the <code>upgrades</code> array contains the list of all "better" transports that are supported by the server</li>
  <li>the <code>pingInterval</code> and <code>pingTimeout</code> values are used in the heartbeat mechanism</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="upgrade-mechanism">Upgrade mechanism<a
    href="#upgrade-mechanism" class="hash-link" aria-label="Direct link to Upgrade mechanism"
    title="Direct link to Upgrade mechanism">​</a></h3>
<p>By default, the client establishes the connection with the HTTP long-polling transport.</p>
<p><strong>But, why?</strong></p>
<p>While WebSocket is clearly the best way to establish a bidirectional communication, experience has shown that it is
  not always possible to establish a WebSocket connection, due to corporate proxies, personal firewall, antivirus
  software...</p>
<p>From the user perspective, an unsuccessful WebSocket connection can translate in up to 10 seconds of waiting for the
  realtime application to begin exchanging data. This <strong>perceptively</strong> hurts user experience.</p>
<p>To summarize, Engine.IO focuses on reliability and user experience first, marginal potential UX improvements and
  increased server performance second.</p>
<p>To upgrade, the client will:</p>
<ul class="">
  <li>ensure its outgoing buffer is empty</li>
  <li>put the current transport in read-only mode</li>
  <li>try to establish a connection with the other transport</li>
  <li>if successful, close the first transport</li>
</ul>
<p>You can check in the Network Monitor of your browser:</p>
<p><img loading="lazy" alt="Successful upgrade"
    src="/assets/images/network-monitor-2e47dbe233100aa290595f8687a9fcba.png" class="img_ev3q" width="585" height="216">
</p>
<ol>
  <li>handshake (contains the session ID — here, <code>zBjrh...AAAK</code> — that is used in subsequent requests)</li>
  <li>send data (HTTP long-polling)</li>
  <li>receive data (HTTP long-polling)</li>
  <li>upgrade (WebSocket)</li>
  <li>receive data (HTTP long-polling, closed once the WebSocket connection in 4. is successfully established)</li>
</ol>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="disconnection-detection">Disconnection detection<a
    href="#disconnection-detection" class="hash-link" aria-label="Direct link to Disconnection detection"
    title="Direct link to Disconnection detection">​</a></h3>
<p>The Engine.IO connection is considered as closed when:</p>
<ul class="">
  <li>one HTTP request (either GET or POST) fails (for example, when the server is shutdown)</li>
  <li>the WebSocket connection is closed (for example, when the user closes the tab in its browser)</li>
  <li><code>socket.disconnect()</code> is called on the server-side or on the client-side</li>
</ul>
<p>There is also a heartbeat mechanism which checks that the connection between the server and the client is still up
  and running:</p>
<p>At a given interval (the <code>pingInterval</code> value sent in the handshake) the server sends a PING packet and
  the client has a few seconds (the <code>pingTimeout</code> value) to send a PONG packet back. If the server does not
  receive a PONG packet back, it will consider that the connection is closed. Conversely, if the client does not receive
  a PING packet within <code>pingInterval + pingTimeout</code>, it will consider that the connection is closed.</p>
<p>The disconnection reasons are listed <a href="/docs/v4/server-socket-instance/#disconnect">here</a> (server-side) and
  <a href="/docs/v4/client-socket-instance/#disconnect">here</a> (client-side).</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="socketio">Socket.IO<a href="#socketio" class="hash-link"
    aria-label="Direct link to Socket.IO" title="Direct link to Socket.IO">​</a></h2>
<p>Socket.IO provides some additional features over the Engine.IO connection:</p>
<ul class="">
  <li>automatic reconnection</li>
  <li><a href="/docs/v4/client-offline-behavior/#buffered-events">packet buffering</a></li>
  <li><a href="/docs/v4/emitting-events/#acknowledgements">acknowledgments</a></li>
  <li>broadcasting <a href="/docs/v4/broadcasting-events/">to all clients</a> or <a href="/docs/v4/rooms/">to a subset
      of clients</a> (what we call "Room")</li>
  <li><a href="/docs/v4/namespaces/">multiplexing</a> (what we call "Namespace")</li>
</ul>
<p>A detailed version of the Socket.IO protocol can be found <a href="/docs/v4/socket-io-protocol/">here</a>.</p>
<p>The source code of the reference implementation (written in TypeScript) can be found here:</p>
<ul class="">
  <li>server: <a href="https://github.com/socketio/socket.io" target="_blank"
      rel="noopener noreferrer">https://github.com/socketio/socket.io</a></li>
  <li>client: <a href="https://github.com/socketio/socket.io-client" target="_blank"
      rel="noopener noreferrer">https://github.com/socketio/socket.io-client</a></li>
  <li>parser: <a href="https://github.com/socketio/socket.io-parser" target="_blank"
      rel="noopener noreferrer">https://github.com/socketio/socket.io-parser</a></li>
</ul>
<header>
  <h1>Delivery guarantees</h1>
</header>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="message-ordering">Message ordering<a href="#message-ordering"
    class="hash-link" aria-label="Direct link to Message ordering" title="Direct link to Message ordering">​</a></h2>
<p>Socket.IO does guarantee message ordering, no matter which low-level transport is used (even during an upgrade from
  HTTP long-polling to WebSocket).</p>
<p>This is achieved thanks to:</p>
<ul class="">
  <li>the guarantees provided by the underlying TCP connection</li>
  <li>the careful design of the <a href="/docs/v4/how-it-works/#upgrade-mechanism">upgrade mechanism</a></li>
</ul>
<p>Example:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"event1"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"event2"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"event3"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>In the example above, the events will always be received in the same order by the other side (provided that they
  actually arrive, see <a href="#message-arrival">below</a>).</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="message-arrival">Message arrival<a href="#message-arrival"
    class="hash-link" aria-label="Direct link to Message arrival" title="Direct link to Message arrival">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="at-most-once">At most once<a href="#at-most-once"
    class="hash-link" aria-label="Direct link to At most once" title="Direct link to At most once">​</a></h3>
<p>By default, Socket.IO provides an <strong>at most once</strong> guarantee of delivery:</p>
<ul class="">
  <li>if the connection is broken while an event is being sent, then there is no guarantee that the other side has
    received it and there will be no retry upon reconnection</li>
  <li>a disconnected client will <a href="/docs/v4/client-offline-behavior/">buffer events until reconnection</a>
    (though the previous point still applies)</li>
  <li>there is no such buffer on the server, which means that any event that was missed by a disconnected client will
    not be transmitted to that client upon reconnection</li>
</ul>
<div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9">
  <div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16">
        <path fill-rule="evenodd"
          d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z">
        </path>
      </svg></span>info</div>
  <div class="admonitionContent_S0QG">
    <p>As of now, additional delivery guarantees must be implemented in your application.</p>
  </div>
</div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="at-least-once">At least once<a href="#at-least-once"
    class="hash-link" aria-label="Direct link to At least once" title="Direct link to At least once">​</a></h3>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="from-client-to-server">From client to server<a
    href="#from-client-to-server" class="hash-link" aria-label="Direct link to From client to server"
    title="Direct link to From client to server">​</a></h4>
<p>From the client side, you can achieve an <strong>at least once</strong> guarantee with <a
    href="/docs/v4/emitting-events/#with-timeout">acknowledgements and timeouts</a>:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword" style="color: rgb(0, 0, 159);">function</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">socket</span><span class="token parameter punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token parameter"> event</span><span class="token parameter punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token parameter"> arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">timeout</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token number" style="color: rgb(54, 172, 170);">2000</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">event</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">err</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">if</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">err</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// no ack from the server, let's retry</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token function" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> event</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token function" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"foo"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"bar"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>In the example above, the client will retry to send the event after a given delay, so the server might receive the
  same event several times.</p>
<div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9">
  <div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16">
        <path fill-rule="evenodd"
          d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z">
        </path>
      </svg></span>caution</div>
  <div class="admonitionContent_S0QG">
    <p>Even in that case, any pending event will be lost if the user refreshes its tab.</p>
  </div>
</div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="from-server-to-client">From server to client<a
    href="#from-server-to-client" class="hash-link" aria-label="Direct link to From server to client"
    title="Direct link to From server to client">​</a></h4>
<p>For events sent by the server, additional delivery guarantees can be implemented by:</p>
<ul class="">
  <li>assigning a unique ID to each event</li>
  <li>persisting the events in a database</li>
  <li>storing the offset of the last received event on the client side, and send it upon reconnection</li>
</ul>
<p>Example:</p>
<p><em>Client</em></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> socket </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">auth</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">offset</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token keyword nil" style="color: rgb(0, 0, 159);">undefined</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"my-event"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token parameter"> id</span><span class="token parameter punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token parameter"> data </span><span class="token parameter punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// do something with the data, and then update the offset</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">auth</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">offset</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> id</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p><em>Server</em></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connection"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">async</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> offset </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">handshake</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">auth</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">offset</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">if</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">offset</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// this is a reconnection</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">for</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> event </span><span class="token keyword" style="color: rgb(0, 0, 159);">of</span><span class="token plain"> </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">await</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">fetchMissedEventsFromDatabase</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">offset</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"my-event"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> event</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">else</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// this is a first connection</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token function" style="color: rgb(215, 58, 73);">setInterval</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token keyword" style="color: rgb(0, 0, 159);">async</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> event </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">id</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">generateUniqueId</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">data</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">new</span><span class="token plain"> </span><span class="token class-name">Date</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">toISOString</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">await</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">persistEventToDatabase</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">event</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"my-event"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> event</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">1000</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>Implementing the missing methods (<code>fetchMissedEventsFromDatabase()</code>, <code>generateUniqueId()</code> and
  <code>persistEventToDatabase()</code>) is database-specific and is left as an exercise for the reader.</p>
<p>References:</p>
<ul class="">
  <li><a href="/docs/v4/client-options/#socket-options"><code>socket.auth</code></a> (client)</li>
  <li><a href="/docs/v4/server-api/#sockethandshake"><code>socket.handshake</code></a> (server)</li>
</ul>
<header>
  <h1>Connection state recovery</h1>
</header>
<p>Connection state recovery is a feature which allows to restore the state of a client after a temporary disconnection,
  including any missed packets. </p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="disclaimer">Disclaimer<a href="#disclaimer" class="hash-link"
    aria-label="Direct link to Disclaimer" title="Direct link to Disclaimer">​</a></h2>
<p>Under real conditions, a Socket.IO client will inevitably experience temporary disconnections, regardless of the
  quality of the connection.</p>
<p>This feature will help you cope with such disconnections, but unless you want to store the packets and the sessions
  forever (by setting <code>maxDisconnectionDuration</code> to <code>Infinity</code>), you can't be assured that the
  recovery will always be successful.</p>
<p>That's why you will still need to handle the case where the states of the client and the server must be synchronized.
</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="usage">Usage<a href="#usage" class="hash-link"
    aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h2>
<p>Connection state recovery must be enabled by the server:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> io </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">new</span><span class="token plain"> </span><span class="token class-name">Server</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">httpServer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">connectionStateRecovery</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// the backup duration of the sessions and the packets</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">maxDisconnectionDuration</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">2</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">*</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">60</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">*</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">1000</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// whether to skip middlewares upon successful recovery</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">skipMiddlewares</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token boolean" style="color: rgb(54, 172, 170);">true</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>Upon an unexpected disconnection (i.e. no manual disconnection with <code>socket.disconnect()</code>), the server
  will store the <code>id</code>, the rooms and the <code>data</code> attribute of the socket.</p>
<p>Then upon reconnection, the server will try to restore the state of the client. The <code>recovered</code> attribute
  indicates whether this recovery was successful:</p>
<p><em>Server</em></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connection"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">if</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">recovered</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// recovery was successful: socket.id, socket.rooms and socket.data were restored</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">else</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// new or unrecoverable session</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p><em>Client</em></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connect"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">if</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">recovered</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// any missed packets will be received</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">else</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// new or unrecoverable session</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>You can check that the recovery is working by forcefully closing the underlying engine:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword module" style="color: rgb(0, 0, 159);">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token imports"> io </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token keyword module" style="color: rgb(0, 0, 159);">from</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"socket.io-client"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> socket </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">reconnectionDelay</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">10000</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// defaults to 1000</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">reconnectionDelayMax</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">10000</span><span class="token plain"> </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// defaults to 5000</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connect"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">log</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"recovered?"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">recovered</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token function" style="color: rgb(215, 58, 73);">setTimeout</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">if</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">engine</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// close the low-level connection and trigger a reconnection</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">engine</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">close</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">10000</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-it-works-under-the-hood">How it works under the hood<a
    href="#how-it-works-under-the-hood" class="hash-link" aria-label="Direct link to How it works under the hood"
    title="Direct link to How it works under the hood">​</a></h2>
<ul class="">
  <li>the server sends a session ID <a href="/docs/v4/socket-io-protocol/#connection-to-a-namespace-1">during the
      handshake</a> (which is different from the current id attribute, which is public and can be freely shared)</li>
</ul>
<p>Example:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">40{"sid":"GNpWD7LbGCBNCr8GAAAB","pid":"YHcX2sdAF1z452-HAAAW"}</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">where</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">4         =&gt; the Engine.IO message type</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">0         =&gt; the Socket.IO CONNECT type</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">GN...AB   =&gt; the public id of the session</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">YH...AW   =&gt; the private id of the session</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<ul class="">
  <li>the server also includes an offset in <a href="/docs/v4/socket-io-protocol/#sending-and-receiving-data-1">each
      packet</a> (added at the end of the data array, for backward compatibility)</li>
</ul>
<p>Example:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">42["foo","MzUPkW0"]</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">where</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">4         =&gt; the Engine.IO message type</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">2         =&gt; the Socket.IO EVENT type</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">foo       =&gt; the event name (socket.emit("foo"))</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">MzUPkW0   =&gt; the offset</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<ul class="">
  <li>
    <p>upon temporary disconnection, the server stores the client state for a given delay (implemented at the adapter
      level)</p>
  </li>
  <li>
    <p>upon reconnection, the client sends both the session ID and the last offset it has processed, and the server
      tries to restore the state</p>
  </li>
</ul>
<p>Example:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">40{"pid":"YHcX2sdAF1z452-HAAAW","offset":"MzUPkW0"}</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">where</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">4         =&gt; the Engine.IO message type</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">0         =&gt; the Socket.IO CONNECT type</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">YH...AW   =&gt; the private id of the session</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">MzUPkW0   =&gt; the last processed offset</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="compatibility-with-existing-adapters">Compatibility with
  existing adapters<a href="#compatibility-with-existing-adapters" class="hash-link"
    aria-label="Direct link to Compatibility with existing adapters"
    title="Direct link to Compatibility with existing adapters">​</a></h2>
<table>
  <thead>
    <tr>
      <th>Adapter</th>
      <th align="center">Support?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Built-in adapter (in memory)</td>
      <td align="center">YES ✅</td>
    </tr>
    <tr>
      <td><a href="/docs/v4/redis-adapter/">Redis adapter</a></td>
      <td align="center">NO<sup>1</sup></td>
    </tr>
    <tr>
      <td><a href="/docs/v4/mongo-adapter/">MongoDB adapter</a></td>
      <td align="center">YES ✅ (since version <a
          href="https://github.com/socketio/socket.io-mongo-adapter/releases/tag/0.3.0" target="_blank"
          rel="noopener noreferrer"><code>0.3.0</code></a>)</td>
    </tr>
    <tr>
      <td><a href="/docs/v4/postgres-adapter/">Postgres adapter</a></td>
      <td align="center">WIP</td>
    </tr>
    <tr>
      <td><a href="/docs/v4/cluster-adapter/">Cluster adapter</a></td>
      <td align="center">WIP</td>
    </tr>
  </tbody>
</table>
<p>[1] Persisting the packets is not compatible with the Redis PUB/SUB mechanism, so we will create a new adapter based
  on <a href="https://redis.io/docs/data-types/streams/" target="_blank" rel="noopener noreferrer">Redis Streams</a>
  which will support this feature.</p>
<header>
  <h1>Logging and debugging</h1>
</header>
<p>Socket.IO is now completely instrumented by a minimalistic yet tremendously powerful utility called <a
    href="https://github.com/visionmedia/debug" target="_blank" rel="noopener noreferrer">debug</a> by TJ Holowaychuk.
</p>
<p>Before 1.0, the Socket.IO server would default to logging everything out to the console. This turned out to be
  annoyingly verbose for many users (although extremely useful for others), so now we default to being completely silent
  by default.</p>
<p>The basic idea is that each module used by Socket.IO provides different debugging scopes that give you insight into
  the internals. By default, all output is suppressed, and you can opt into seeing messages by supplying the
  <code>DEBUG</code> env variable (Node.JS) or the <code>localStorage.debug</code> property (Browsers).</p>
<p>You can see it in action for example on our homepage:</p><video id="debugging-vid"
  data-setup="{&quot;autoplay&quot;:true,&quot;loop&quot;:true, &quot;techOrder&quot;: [&quot;html5&quot;, &quot;flash&quot;], &quot;height&quot;: 300}"
  class="video-js vjs-default-skin" loop="" width="100%">
  <source src="https://i.cloudup.com/transcoded/IL9alTr0eO.mp4" type="video/mp4">
</video>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="available-debugging-scopes">Available debugging scopes<a
    href="#available-debugging-scopes" class="hash-link" aria-label="Direct link to Available debugging scopes"
    title="Direct link to Available debugging scopes">​</a></h2>
<p>The best way to see what information is available is to use the <code>*</code>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">DEBUG=* node yourfile.js</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>or in the browser:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">localStorage.debug = '*';</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>And then filter by the scopes you’re interested in. You can prefix the <code>*</code> with scopes, separated by comma
  if there is more than one. For example, to only see debug statements from the socket.io client on Node.js try this:
</p>
<div class="codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">DEBUG=socket.io:client* node yourfile.js</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>To see all debug messages from the engine <em>and</em> socket.io:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">DEBUG=engine,socket.io* node yourfile.js</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="removing-debug-from-your-browser-bundle">Removing debug from
  your browser bundle<a href="#removing-debug-from-your-browser-bundle" class="hash-link"
    aria-label="Direct link to Removing debug from your browser bundle"
    title="Direct link to Removing debug from your browser bundle">​</a></h3>
<p>While useful during development, the debug package adds an extra weight to the final bundle (about 4KB minified and
  gzipped), that's why it is excluded from the slim bundle (more details about the various browser bundles can be found
  <a href="/docs/v4/client-installation/#from-a-cdn">here</a>).</p>
<p>If you are using webpack, you can remove it with <a href="https://github.com/johngodley/webpack-remove-debug"
    target="_blank" rel="noopener noreferrer">webpack-remove-debug</a>:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">module</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">rules</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">[</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">test</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token regex regex-delimiter" style="color: rgb(54, 172, 170);">/</span><span class="token regex regex-source language-regex" style="color: rgb(54, 172, 170);">\.js$</span><span class="token regex regex-delimiter" style="color: rgb(54, 172, 170);">/</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">loader</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">'webpack-remove-debug'</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(57, 58, 52);">]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="error-logs-in-the-browser-console">Error logs in the browser
  console<a href="#error-logs-in-the-browser-console" class="hash-link"
    aria-label="Direct link to Error logs in the browser console"
    title="Direct link to Error logs in the browser console">​</a></h2>
<p>Please note that error logs such as:</p>
<ul class="">
  <li><code>net::ERR_INTERNET_DISCONNECTED</code></li>
  <li><code>net::ERR_CONNECTION_REFUSED</code></li>
  <li><code>WebSocket is already in CLOSING or CLOSED state</code></li>
  <li>
    <code>Cross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource at xxx. (Reason: CORS header ‘Access-Control-Allow-Origin’ missing).</code>
  </li>
  <li><code>The connection to xxx was interrupted while the page was loading</code></li>
</ul>
<p>are not emitted by the Socket.IO library but by the browser itself, and are therefore out of our control.</p>
<header>
  <h1>Testing</h1>
</header>
<p>You will find below some code examples with common testing libraries:</p>
<ul class="">
  <li><a href="#example-with-mocha">mocha</a></li>
  <li><a href="#example-with-jest">jest</a></li>
  <li><a href="#example-with-tape">tape</a></li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="example-with-mocha">Example with <code>mocha</code><a
    href="#example-with-mocha" class="hash-link" aria-label="Direct link to example-with-mocha"
    title="Direct link to example-with-mocha">​</a></h2>
<p>Installation: <code>npm i -D mocha chai</code></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// with { "type": "module" } in your package.json</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword module" style="color: rgb(0, 0, 159);">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token imports"> createServer </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token keyword module" style="color: rgb(0, 0, 159);">from</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"http"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword module" style="color: rgb(0, 0, 159);">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token imports"> io </span><span class="token imports keyword module" style="color: rgb(0, 0, 159);">as</span><span class="token imports"> </span><span class="token imports maybe-class-name">Client</span><span class="token imports"> </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token keyword module" style="color: rgb(0, 0, 159);">from</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"socket.io-client"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword module" style="color: rgb(0, 0, 159);">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Server</span><span class="token imports"> </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token keyword module" style="color: rgb(0, 0, 159);">from</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"socket.io"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword module" style="color: rgb(0, 0, 159);">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token imports"> assert </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token keyword module" style="color: rgb(0, 0, 159);">from</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"chai"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// with { "type": "commonjs" } in your package.json</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// const { createServer } = require("http");</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// const { Server } = require("socket.io");</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// const Client = require("socket.io-client");</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// const assert = require("chai").assert;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token function" style="color: rgb(215, 58, 73);">describe</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"my awesome project"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token keyword" style="color: rgb(0, 0, 159);">let</span><span class="token plain"> io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> serverSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> clientSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token function" style="color: rgb(215, 58, 73);">before</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">done</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> httpServer </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">createServer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    io </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">new</span><span class="token plain"> </span><span class="token class-name">Server</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">httpServer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    httpServer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">listen</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> port </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> httpServer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">address</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">port</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      clientSocket </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">new</span><span class="token plain"> </span><span class="token class-name">Client</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token template-string template-punctuation string" style="color: rgb(227, 17, 108);">`</span><span class="token template-string string" style="color: rgb(227, 17, 108);">http://localhost:</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color: rgb(57, 58, 52);">${</span><span class="token template-string interpolation">port</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token template-string template-punctuation string" style="color: rgb(227, 17, 108);">`</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connection"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        serverSocket </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      clientSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connect"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> done</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token function" style="color: rgb(215, 58, 73);">after</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">close</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    clientSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">close</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token function" style="color: rgb(215, 58, 73);">it</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"should work"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">done</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    clientSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      assert</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">equal</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"world"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token function" style="color: rgb(215, 58, 73);">done</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    serverSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"world"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token function" style="color: rgb(215, 58, 73);">it</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"should work (with ack)"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">done</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    serverSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hi"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">cb</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token function" style="color: rgb(215, 58, 73);">cb</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hola"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    clientSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hi"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      assert</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">equal</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"hola"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token function" style="color: rgb(215, 58, 73);">done</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="example-with-jest">Example with <code>jest</code><a
    href="#example-with-jest" class="hash-link" aria-label="Direct link to example-with-jest"
    title="Direct link to example-with-jest">​</a></h2>
<p>Installation: <code>npm i -D jest</code></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"> createServer </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">require</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"http"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"> </span><span class="token maybe-class-name">Server</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">require</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"socket.io"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> </span><span class="token maybe-class-name">Client</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">require</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"socket.io-client"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token function" style="color: rgb(215, 58, 73);">describe</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"my awesome project"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token keyword" style="color: rgb(0, 0, 159);">let</span><span class="token plain"> io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> serverSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> clientSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token function" style="color: rgb(215, 58, 73);">beforeAll</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">done</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> httpServer </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">createServer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    io </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">new</span><span class="token plain"> </span><span class="token class-name">Server</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">httpServer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    httpServer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">listen</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> port </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> httpServer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">address</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">port</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      clientSocket </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">new</span><span class="token plain"> </span><span class="token class-name">Client</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token template-string template-punctuation string" style="color: rgb(227, 17, 108);">`</span><span class="token template-string string" style="color: rgb(227, 17, 108);">http://localhost:</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color: rgb(57, 58, 52);">${</span><span class="token template-string interpolation">port</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token template-string template-punctuation string" style="color: rgb(227, 17, 108);">`</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connection"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        serverSocket </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      clientSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connect"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> done</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token function" style="color: rgb(215, 58, 73);">afterAll</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">close</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    clientSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">close</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token function" style="color: rgb(215, 58, 73);">test</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"should work"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">done</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    clientSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token function" style="color: rgb(215, 58, 73);">expect</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">toBe</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"world"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token function" style="color: rgb(215, 58, 73);">done</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    serverSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"world"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token function" style="color: rgb(215, 58, 73);">test</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"should work (with ack)"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">done</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    serverSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hi"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">cb</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token function" style="color: rgb(215, 58, 73);">cb</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hola"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    clientSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hi"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token function" style="color: rgb(215, 58, 73);">expect</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">toBe</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hola"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token function" style="color: rgb(215, 58, 73);">done</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="example-with-tape">Example with <code>tape</code><a
    href="#example-with-tape" class="hash-link" aria-label="Direct link to example-with-tape"
    title="Direct link to example-with-tape">​</a></h2>
<p>Installation: <code>npm i -D tape</code></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"> createServer </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">require</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"http"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"> </span><span class="token maybe-class-name">Server</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">require</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"socket.io"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> </span><span class="token maybe-class-name">Client</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">require</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"socket.io-client"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> test </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">require</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"tape"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">let</span><span class="token plain"> io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> serverSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> clientSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token function" style="color: rgb(215, 58, 73);">test</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"setup"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">t</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> httpServer </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">createServer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  io </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">new</span><span class="token plain"> </span><span class="token class-name">Server</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">httpServer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  httpServer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">listen</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> port </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> httpServer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">address</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">port</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    clientSocket </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">new</span><span class="token plain"> </span><span class="token class-name">Client</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token template-string template-punctuation string" style="color: rgb(227, 17, 108);">`</span><span class="token template-string string" style="color: rgb(227, 17, 108);">http://localhost:</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color: rgb(57, 58, 52);">${</span><span class="token template-string interpolation">port</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token template-string template-punctuation string" style="color: rgb(227, 17, 108);">`</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connection"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      serverSocket </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    clientSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connect"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> t</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">end</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token function" style="color: rgb(215, 58, 73);">test</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"it works"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">t</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  t</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">plan</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token number" style="color: rgb(54, 172, 170);">1</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  clientSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    t</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">equal</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"world"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  serverSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"world"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token function" style="color: rgb(215, 58, 73);">test</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"it works (with ack)"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">t</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  t</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">plan</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token number" style="color: rgb(54, 172, 170);">1</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  serverSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hi"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">cb</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token function" style="color: rgb(215, 58, 73);">cb</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hola"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  clientSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hi"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    t</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">equal</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"hola"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">test</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">onFinish</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">close</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  clientSocket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">close</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<header>
  <h1>Troubleshooting connection issues</h1>
</header>
<div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9">
  <div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16">
        <path fill-rule="evenodd"
          d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z">
        </path>
      </svg></span>tip</div>
  <div class="admonitionContent_S0QG">
    <p>The <a href="/docs/v4/admin-ui/">Admin UI</a> can give you additional insights about the status of your Socket.IO
      deployment.</p>
  </div>
</div>
<p>Common/known issues:</p>
<ul class="">
  <li><a href="#problem-the-socket-is-not-able-to-connect">the socket is not able to connect</a></li>
  <li><a href="#problem-the-socket-gets-disconnected">the socket gets disconnected</a></li>
  <li><a href="#problem-the-socket-is-stuck-in-http-long-polling">the socket is stuck in HTTP long-polling</a></li>
  <li><a href="#other-common-gotchas">other common gotchas</a></li>
</ul>
<p>Other common gotchas:</p>
<ul class="">
  <li><a href="#delayed-event-handler-registration">Delayed event handler registration</a></li>
  <li><a href="#usage-of-the-socketid-attribute">Usage of the <code>socket.id</code> attribute</a></li>
  <li><a href="#deployment-on-a-serverless-platform">Deployment on a serverless platform</a></li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="problem-the-socket-is-not-able-to-connect">Problem: the socket
  is not able to connect<a href="#problem-the-socket-is-not-able-to-connect" class="hash-link"
    aria-label="Direct link to Problem: the socket is not able to connect"
    title="Direct link to Problem: the socket is not able to connect">​</a></h2>
<p>Possible explanations:</p>
<ul class="">
  <li><a href="#you-are-trying-to-reach-a-plain-websocket-server">You are trying to reach a plain WebSocket server</a>
  </li>
  <li><a href="#the-server-is-not-reachable">The server is not reachable</a></li>
  <li><a href="#the-client-is-not-compatible-with-the-version-of-the-server">The client is not compatible with the
      version of the server</a></li>
  <li><a href="#the-server-does-not-send-the-necessary-cors-headers">The server does not send the necessary CORS
      headers</a></li>
  <li><a href="#you-didnt-enable-sticky-sessions-in-a-multi-server-setup">You didn’t enable sticky sessions (in a multi
      server setup)</a></li>
  <li><a href="#the-request-path-does-not-match-on-both-sides">The request path does not match on both sides</a></li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="you-are-trying-to-reach-a-plain-websocket-server">You are
  trying to reach a plain WebSocket server<a href="#you-are-trying-to-reach-a-plain-websocket-server" class="hash-link"
    aria-label="Direct link to You are trying to reach a plain WebSocket server"
    title="Direct link to You are trying to reach a plain WebSocket server">​</a></h3>
<p>As explained in the <a href="/docs/v4/#what-socketio-is-not">"What Socket.IO is not"</a> section, the Socket.IO
  client is not a WebSocket implementation and thus will not be able to establish a connection with a WebSocket server,
  even with <code>transports: ["websocket"]</code>:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> socket </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"ws://echo.websocket.org"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">transports</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">[</span><span class="token string" style="color: rgb(227, 17, 108);">"websocket"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-server-is-not-reachable">The server is not reachable<a
    href="#the-server-is-not-reachable" class="hash-link" aria-label="Direct link to The server is not reachable"
    title="Direct link to The server is not reachable">​</a></h3>
<p>Please make sure the Socket.IO server is actually reachable at the given URL. You can test it with:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">curl "&lt;the server URL&gt;/socket.io/?EIO=4&amp;transport=polling"</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>which should return something like this:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">0{"sid":"Lbo5JLzTotvW3g2LAAAA","upgrades":["websocket"],"pingInterval":25000,"pingTimeout":20000}</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>If that's not the case, please check that the Socket.IO server is running, and that there is nothing in between that
  prevents the connection.</p>
<p>Note: v1/v2 servers (which implement the v3 of the protocol, hence the <code>EIO=3</code>) will return something like
  this:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">96:0{"sid":"ptzi_578ycUci8WLB9G1","upgrades":["websocket"],"pingInterval":25000,"pingTimeout":5000}2:40</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-client-is-not-compatible-with-the-version-of-the-server">
  The client is not compatible with the version of the server<a
    href="#the-client-is-not-compatible-with-the-version-of-the-server" class="hash-link"
    aria-label="Direct link to The client is not compatible with the version of the server"
    title="Direct link to The client is not compatible with the version of the server">​</a></h3>
<p>Maintaining backward compatibility is a top priority for us, but in some particular cases we had to implement some
  breaking changes at the protocol level:</p>
<ul class="">
  <li>from v1.x to v2.0.0 (released in May 2017), to improve the compatibility with non-Javascript clients (see <a
      href="https://github.com/socketio/engine.io/issues/315" target="_blank" rel="noopener noreferrer">here</a>)</li>
  <li>from v2.x to v3.0.0 (released in November 2020), to fix some long-standing issues in the protocol once for all
    (see <a href="/docs/v4/migrating-from-2-x-to-3-0/">here</a>)</li>
</ul>
<div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9">
  <div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16">
        <path fill-rule="evenodd"
          d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z">
        </path>
      </svg></span>info</div>
  <div class="admonitionContent_S0QG">
    <p><code>v4.0.0</code> contains some breaking changes in the API of the JavaScript server. The Socket.IO protocol
      itself was not updated, so a v3 client will be able to reach a v4 server and vice-versa (see <a
        href="/docs/v4/migrating-from-3-x-to-4-0/">here</a>).</p>
  </div>
</div>
<p>For example, reaching a v3/v4 server with a v1/v2 client will result in the following response:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">&lt; HTTP/1.1 400 Bad Request</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">&lt; Content-Type: application/json</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">{"code":5,"message":"Unsupported protocol version"}</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>Here is the compatibility table for the <a href="https://github.com/socketio/socket.io-client/" target="_blank"
    rel="noopener noreferrer">JS client</a>:</p>
<table>
  <tr>
    <th rowspan="2">JS Client version</th>
    <th colspan="4">Socket.IO server version</th>
  </tr>
  <tr>
    <td align="center">1.x</td>
    <td align="center">2.x</td>
    <td align="center">3.x</td>
    <td align="center">4.x</td>
  </tr>
  <tr>
    <td align="center">1.x</td>
    <td align="center"><b>YES</b></td>
    <td align="center">NO</td>
    <td align="center">NO</td>
    <td align="center">NO</td>
  </tr>
  <tr>
    <td align="center">2.x</td>
    <td align="center">NO</td>
    <td align="center"><b>YES</b></td>
    <td align="center"><b>YES</b><sup>1</sup></td>
    <td align="center"><b>YES</b><sup>1</sup></td>
  </tr>
  <tr>
    <td align="center">3.x</td>
    <td align="center">NO</td>
    <td align="center">NO</td>
    <td align="center"><b>YES</b></td>
    <td align="center"><b>YES</b></td>
  </tr>
  <tr>
    <td align="center">4.x</td>
    <td align="center">NO</td>
    <td align="center">NO</td>
    <td align="center"><b>YES</b></td>
    <td align="center"><b>YES</b></td>
  </tr>
</table>
<p>[1] Yes, with <a href="/docs/v4/server-options/#alloweio3">allowEIO3: true</a></p>
<p>Here is the compatibility table for the <a href="https://github.com/socketio/socket.io-client-java/" target="_blank"
    rel="noopener noreferrer">Java client</a>:</p>
<table>
  <tr>
    <th rowspan="2">Java Client version</th>
    <th colspan="3">Socket.IO server version</th>
  </tr>
  <tr>
    <td align="center">2.x</td>
    <td align="center">3.x</td>
    <td align="center">4.x</td>
  </tr>
  <tr>
    <td align="center">1.x</td>
    <td align="center"><b>YES</b></td>
    <td align="center"><b>YES</b><sup>1</sup></td>
    <td align="center"><b>YES</b><sup>1</sup></td>
  </tr>
  <tr>
    <td align="center">2.x</td>
    <td align="center">NO</td>
    <td align="center"><b>YES</b></td>
    <td align="center"><b>YES</b></td>
  </tr>
</table>
<p>[1] Yes, with <a href="/docs/v4/server-options/#alloweio3">allowEIO3: true</a></p>
<p>Here is the compatibility table for the <a href="https://github.com/socketio/socket.io-client-swift/" target="_blank"
    rel="noopener noreferrer">Swift client</a>:</p>
<table>
  <tr>
    <th rowspan="2">Swift Client version</th>
    <th colspan="3">Socket.IO server version</th>
  </tr>
  <tr>
    <td align="center">2.x</td>
    <td align="center">3.x</td>
    <td align="center">4.x</td>
  </tr>
  <tr>
    <td align="center">v15.x</td>
    <td align="center"><b>YES</b></td>
    <td align="center"><b>YES</b><sup>1</sup></td>
    <td align="center"><b>YES</b><sup>2</sup></td>
  </tr>
  <tr>
    <td align="center">v16.x</td>
    <td align="center"><b>YES</b><sup>3</sup></td>
    <td align="center"><b>YES</b></td>
    <td align="center"><b>YES</b></td>
  </tr>
</table>
<p>[1] Yes, with <a href="/docs/v4/server-options/#alloweio3">allowEIO3: true</a> (server) and
  <code>.connectParams(["EIO": "3"])</code> (client):</p>
<div class="language-swift codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-swift codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">SocketManager(socketURL: URL(string:"http://localhost:8087/")!, config: [.connectParams(["EIO": "3"])])</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>[2] Yes, <a href="/docs/v4/server-options/#alloweio3">allowEIO3: true</a> (server)</p>
<p>[3] Yes, with <code>.version(.two)</code> (client):</p>
<div class="language-swift codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-swift codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">SocketManager(socketURL: URL(string:"http://localhost:8087/")!, config: [.version(.two)])</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-server-does-not-send-the-necessary-cors-headers">The server
  does not send the necessary CORS headers<a href="#the-server-does-not-send-the-necessary-cors-headers"
    class="hash-link" aria-label="Direct link to The server does not send the necessary CORS headers"
    title="Direct link to The server does not send the necessary CORS headers">​</a></h3>
<p>If you see the following error in your console:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">Cross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource at ...</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>It probably means that:</p>
<ul class="">
  <li>either you are not actually reaching the Socket.IO server (see <a href="#the-server-is-not-reachable">above</a>)
  </li>
  <li>or you didn't enable <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS" target="_blank"
      rel="noopener noreferrer">Cross-Origin Resource Sharing</a> (CORS) on the server-side.</li>
</ul>
<p>Please see the documentation <a href="/docs/v4/handling-cors/">here</a>.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="you-didnt-enable-sticky-sessions-in-a-multi-server-setup">You
  didn't enable sticky sessions (in a multi server setup)<a
    href="#you-didnt-enable-sticky-sessions-in-a-multi-server-setup" class="hash-link"
    aria-label="Direct link to You didn't enable sticky sessions (in a multi server setup)"
    title="Direct link to You didn't enable sticky sessions (in a multi server setup)">​</a></h3>
<p>When scaling to multiple Socket.IO servers, you need to make sure that all the requests of a given Socket.IO session
  reach the same Socket.IO server. The explanation can be found <a
    href="/docs/v4/using-multiple-nodes/#why-is-sticky-session-required">here</a>.</p>
<p>Failure to do so will result in HTTP 400 responses with the code:
  <code>{"code":1,"message":"Session ID unknown"}</code></p>
<p>Please see the documentation <a href="/docs/v4/using-multiple-nodes/">here</a>.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-request-path-does-not-match-on-both-sides">The request path
  does not match on both sides<a href="#the-request-path-does-not-match-on-both-sides" class="hash-link"
    aria-label="Direct link to The request path does not match on both sides"
    title="Direct link to The request path does not match on both sides">​</a></h3>
<p>By default, the client sends — and the server expects — HTTP requests with the "/socket.io/" request path.</p>
<p>This can be controlled with the <code>path</code> option:</p>
<p><em>Server</em></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword module" style="color: rgb(0, 0, 159);">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Server</span><span class="token imports"> </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token keyword module" style="color: rgb(0, 0, 159);">from</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"socket.io"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> io </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">new</span><span class="token plain"> </span><span class="token class-name">Server</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">path</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"/my-custom-path/"</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">listen</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token number" style="color: rgb(54, 172, 170);">3000</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p><em>Client</em></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword module" style="color: rgb(0, 0, 159);">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token imports"> io </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token keyword module" style="color: rgb(0, 0, 159);">from</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"socket.io-client"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> socket </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token constant" style="color: rgb(54, 172, 170);">SERVER_URL</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">path</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"/my-custom-path/"</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>In that case, the HTTP requests will look like
  <code>&lt;SERVER_URL&gt;/my-custom-path/?EIO=4&amp;transport=polling[&amp;...]</code>.</p>
<div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9">
  <div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16">
        <path fill-rule="evenodd"
          d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z">
        </path>
      </svg></span>caution</div>
  <div class="admonitionContent_S0QG">
    <div class="language-js codeBlockContainer_Ckt0 theme-code-block"
      style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
      <div class="codeBlockContent_biex">
        <pre tabindex="0"
          class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword module" style="color: rgb(0, 0, 159);">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token imports"> io </span><span class="token imports punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token keyword module" style="color: rgb(0, 0, 159);">from</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"socket.io-client"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> socket </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"/my-custom-path/"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
        <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
            class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
                viewBox="0 0 24 24">
                <path
                  d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
                </path>
              </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
                <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
              </svg></span></button></div>
      </div>
    </div>
    <p>means the client will try to reach the <a href="/docs/v4/namespaces/">namespace</a> named "/my-custom-path/", but
      the request path will still be "/socket.io/".</p>
  </div>
</div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="problem-the-socket-gets-disconnected">Problem: the socket gets
  disconnected<a href="#problem-the-socket-gets-disconnected" class="hash-link"
    aria-label="Direct link to Problem: the socket gets disconnected"
    title="Direct link to Problem: the socket gets disconnected">​</a></h2>
<p>First and foremost, please note that disconnections are common and expected, even on a stable Internet connection:
</p>
<ul class="">
  <li>anything between the user and the Socket.IO server may encounter a temporary failure or be restarted</li>
  <li>the server itself may be killed as part of an autoscaling policy</li>
  <li>the user may lose connection or switch from WiFi to 4G, in case of a mobile browser</li>
  <li>the browser itself may freeze an inactive tab</li>
</ul>
<p>That being said, the Socket.IO client will always try to reconnect, unless specifically told <a
    href="/docs/v4/client-options/#reconnection">otherwise</a>.</p>
<p>Possible explanations for a disconnection:</p>
<ul class="">
  <li><a href="#the-browser-tab-was-minimized-and-heartbeat-has-failed">The browser tab was minimized and heartbeat has
      failed</a></li>
  <li><a href="#the-client-is-not-compatible-with-the-version-of-the-server-1">The client is not compatible with the
      version of the server</a></li>
  <li><a href="#you-are-trying-to-send-a-huge-payload">You are trying to send a huge payload</a></li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-browser-tab-was-minimized-and-heartbeat-has-failed">The
  browser tab was minimized and heartbeat has failed<a href="#the-browser-tab-was-minimized-and-heartbeat-has-failed"
    class="hash-link" aria-label="Direct link to The browser tab was minimized and heartbeat has failed"
    title="Direct link to The browser tab was minimized and heartbeat has failed">​</a></h4>
<p>When a browser tab is not in focus, some browsers (like <a
    href="https://developer.chrome.com/blog/timer-throttling-in-chrome-88/#intensive-throttling" target="_blank"
    rel="noopener noreferrer">Chrome</a>) throttle JavaScript timers, which could lead to a disconnection by ping
  timeout <strong>in Socket.IO v2</strong>, as the heartbeat mechanism relied on <code>setTimeout</code> function on the
  client side.</p>
<p>As a workaround, you can increase the <code>pingTimeout</code> value on the server side:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> io </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">new</span><span class="token plain"> </span><span class="token class-name">Server</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">pingTimeout</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">60000</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>Please note that upgrading to Socket.IO v4 (at least <code>socket.io-client@4.1.3</code>, due to <a
    href="https://github.com/socketio/engine.io-client/commit/f30a10b7f45517fcb3abd02511c58a89e0ef498f" target="_blank"
    rel="noopener noreferrer">this</a>) should prevent this kind of issues, as the heartbeat mechanism has been reversed
  (the server now sends PING packets).</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-client-is-not-compatible-with-the-version-of-the-server-1">
  The client is not compatible with the version of the server<a
    href="#the-client-is-not-compatible-with-the-version-of-the-server-1" class="hash-link"
    aria-label="Direct link to The client is not compatible with the version of the server"
    title="Direct link to The client is not compatible with the version of the server">​</a></h3>
<p>Since the format of the packets sent over the WebSocket transport is similar in v2 and v3/v4, you might be able to
  connect with an incompatible client (see <a
    href="#the-client-is-not-compatible-with-the-version-of-the-server">above</a>), but the connection will eventually
  be closed after a given delay.</p>
<p>So if you are experiencing a regular disconnection after 30 seconds (which was the sum of the values of <a
    href="/docs/v4/server-options/#pingtimeout">pingTimeout</a> and <a
    href="/docs/v4/server-options/#pinginterval">pingInterval</a> in Socket.IO v2), this is certainly due to a version
  incompatibility.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="you-are-trying-to-send-a-huge-payload">You are trying to send a
  huge payload<a href="#you-are-trying-to-send-a-huge-payload" class="hash-link"
    aria-label="Direct link to You are trying to send a huge payload"
    title="Direct link to You are trying to send a huge payload">​</a></h3>
<p>If you get disconnected while sending a huge payload, this may mean that you have reached the <a
    href="/docs/v4/server-options/#maxhttpbuffersize"><code>maxHttpBufferSize</code></a> value, which defaults to 1 MB.
  Please adjust it according to your needs:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> io </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">require</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"socket.io"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">httpServer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">maxHttpBufferSize</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">1e8</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>A huge payload taking more time to upload than the value of the <a
    href="/docs/v4/server-options/#pingtimeout"><code>pingTimeout</code></a> option can also trigger a disconnection
  (since the <a href="/docs/v4/how-it-works/#disconnection-detection">heartbeat mechanism</a> fails during the upload).
  Please adjust it according to your needs:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> io </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">require</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"socket.io"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">httpServer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token literal-property property" style="color: rgb(54, 172, 170);">pingTimeout</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">60000</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="problem-the-socket-is-stuck-in-http-long-polling">Problem: the
  socket is stuck in HTTP long-polling<a href="#problem-the-socket-is-stuck-in-http-long-polling" class="hash-link"
    aria-label="Direct link to Problem: the socket is stuck in HTTP long-polling"
    title="Direct link to Problem: the socket is stuck in HTTP long-polling">​</a></h2>
<p>In most cases, you should see something like this:</p>
<p><img loading="lazy" alt="Network monitor upon success"
    src="/assets/images/network-monitor-2e47dbe233100aa290595f8687a9fcba.png" class="img_ev3q" width="585" height="216">
</p>
<ol>
  <li>the Engine.IO handshake (contains the session ID — here, <code>zBjrh...AAAK</code> — that is used in subsequent
    requests)</li>
  <li>the Socket.IO handshake request (contains the value of the <code>auth</code> option)</li>
  <li>the Socket.IO handshake response (contains the <a href="/docs/v4/server-socket-instance/#socketid">Socket#id</a>)
  </li>
  <li>the WebSocket connection</li>
  <li>the first HTTP long-polling request, which is closed once the WebSocket connection is established</li>
</ol>
<p>If you don't see a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/101" target="_blank"
    rel="noopener noreferrer">HTTP 101 Switching Protocols</a> response for the 4th request, that means that something
  between the server and your browser is preventing the WebSocket connection.</p>
<p>Please note that this is not necessarily blocking since the connection is still established with HTTP long-polling,
  but it is less efficient.</p>
<p>You can get the name of the current transport with:</p>
<p><strong>Client-side</strong></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connect"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> transport </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">engine</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">transport</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">name</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"> </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// in most cases, "polling"</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">engine</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"upgrade"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> upgradedTransport </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">engine</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">transport</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">name</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"> </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// in most cases, "websocket"</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p><strong>Server-side</strong></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connection"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> transport </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">conn</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">transport</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">name</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"> </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// in most cases, "polling"</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">conn</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"upgrade"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> upgradedTransport </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">conn</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">transport</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">name</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"> </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// in most cases, "websocket"</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>Possible explanations:</p>
<ul class="">
  <li><a href="#a-proxy-in-front-of-your-servers-does-not-accept-the-WebSocket-connection">a proxy in front of your
      servers does not accept the WebSocket connection</a></li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5"
  id="a-proxy-in-front-of-your-servers-does-not-accept-the-websocket-connection">A proxy in front of your servers does
  not accept the WebSocket connection<a
    href="#a-proxy-in-front-of-your-servers-does-not-accept-the-websocket-connection" class="hash-link"
    aria-label="Direct link to A proxy in front of your servers does not accept the WebSocket connection"
    title="Direct link to A proxy in front of your servers does not accept the WebSocket connection">​</a></h3>
<p>Please see the documentation <a href="/docs/v4/reverse-proxy/">here</a>.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="other-common-gotchas">Other common gotchas<a
    href="#other-common-gotchas" class="hash-link" aria-label="Direct link to Other common gotchas"
    title="Direct link to Other common gotchas">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="delayed-event-handler-registration">Delayed event handler
  registration<a href="#delayed-event-handler-registration" class="hash-link"
    aria-label="Direct link to Delayed event handler registration"
    title="Direct link to Delayed event handler registration">​</a></h3>
<p>BAD:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connection"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">async</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">await</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">longRunningOperation</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// WARNING! Some packets might be received by the server but without handler</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>GOOD:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connection"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">async</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">await</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">longRunningOperation</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="usage-of-the-socketid-attribute">Usage of the
  <code>socket.id</code> attribute<a href="#usage-of-the-socketid-attribute" class="hash-link"
    aria-label="Direct link to usage-of-the-socketid-attribute"
    title="Direct link to usage-of-the-socketid-attribute">​</a></h3>
<p>Please note that, unless <a href="/docs/v4/connection-state-recovery">connection state recovery</a> is enabled, the
  <code>id</code> attribute is an <strong>ephemeral</strong> ID that is not meant to be used in your application (or
  only for debugging purposes) because:</p>
<ul class="">
  <li>this ID is regenerated after each reconnection (for example when the WebSocket connection is severed, or when the
    user refreshes the page)</li>
  <li>two different browser tabs will have two different IDs</li>
  <li>there is no message queue stored for a given ID on the server (i.e. if the client is disconnected, the messages
    sent from the server to this ID are lost)</li>
</ul>
<p>Please use a regular session ID instead (either sent in a cookie, or stored in the localStorage and sent in the <a
    href="/docs/v4/client-options/#auth"><code>auth</code></a> payload).</p>
<p>See also:</p>
<ul class="">
  <li><a href="/get-started/private-messaging-part-2/">Part II of our private message guide</a></li>
  <li><a href="/how-to/deal-with-cookies">How to deal with cookies</a></li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="deployment-on-a-serverless-platform">Deployment on a serverless
  platform<a href="#deployment-on-a-serverless-platform" class="hash-link"
    aria-label="Direct link to Deployment on a serverless platform"
    title="Direct link to Deployment on a serverless platform">​</a></h3>
<p>Since most serverless platforms (such as Vercel) bill by the duration of the request handler, maintaining a
  long-running connection with Socket.IO (or even plain WebSocket) is not recommended.</p>
<p>References:</p>
<ul class="">
  <li><a href="https://vercel.com/guides/do-vercel-serverless-functions-support-websocket-connections" target="_blank"
      rel="noopener noreferrer">https://vercel.com/guides/do-vercel-serverless-functions-support-websocket-connections</a>
  </li>
  <li><a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-websocket-api.html"
      target="_blank"
      rel="noopener noreferrer">https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-websocket-api.html</a>
  </li>
</ul>
<header>
  <h1>TypeScript</h1>
</header>
<p>Starting with v3, Socket.IO now has first class support for <a href="https://www.typescriptlang.org/" target="_blank"
    rel="noopener noreferrer">TypeScript</a>.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="types-for-the-server">Types for the server<a
    href="#types-for-the-server" class="hash-link" aria-label="Direct link to Types for the server"
    title="Direct link to Types for the server">​</a></h2>
<p>First, declare some types:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword" style="color: rgb(0, 0, 159);">interface</span><span class="token plain"> </span><span class="token class-name">ServerToClientEvents</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token function-variable function" style="color: rgb(215, 58, 73);">noArg</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">void</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token function-variable function" style="color: rgb(215, 58, 73);">basicEmit</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">a</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> b</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> c</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> Buffer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">void</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token function-variable function" style="color: rgb(215, 58, 73);">withAck</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">d</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token function-variable function" style="color: rgb(215, 58, 73);">callback</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">e</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">void</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">void</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">interface</span><span class="token plain"> </span><span class="token class-name">ClientToServerEvents</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token function-variable function" style="color: rgb(215, 58, 73);">hello</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">void</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">interface</span><span class="token plain"> </span><span class="token class-name">InterServerEvents</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token function-variable function" style="color: rgb(215, 58, 73);">ping</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">void</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">interface</span><span class="token plain"> </span><span class="token class-name">SocketData</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  name</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  age</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>And use them when creating your server:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> io </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">new</span><span class="token plain"> </span><span class="token class-name">Server</span><span class="token class-name operator" style="color: rgb(57, 58, 52);">&lt;</span><span class="token class-name"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token class-name">  ClientToServerEvents</span><span class="token class-name punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token class-name"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token class-name">  ServerToClientEvents</span><span class="token class-name punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token class-name"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token class-name">  InterServerEvents</span><span class="token class-name punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token class-name"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token class-name">  SocketData</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token class-name"></span><span class="token class-name operator" style="color: rgb(57, 58, 52);">&gt;</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>Then, profit from the help of your IDE!</p>
<p>The events declared in the <code>ServerToClientEvents</code> interface are used when sending and broadcasting events:
</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connection"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"noArg"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"basicEmit"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">1</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"2"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> Buffer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">from</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">[</span><span class="token number" style="color: rgb(54, 172, 170);">3</span><span class="token punctuation" style="color: rgb(57, 58, 52);">]</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"withAck"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"4"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">e</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// e is inferred as number</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// works when broadcast to all</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"noArg"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// works when broadcasting to a room</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">to</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"room1"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"basicEmit"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">1</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"2"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> Buffer</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">from</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">[</span><span class="token number" style="color: rgb(54, 172, 170);">3</span><span class="token punctuation" style="color: rgb(57, 58, 52);">]</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>The ones declared in the <code>ClientToServerEvents</code> interface are used when receiving events:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connection"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>The ones declared in the <code>InterServerEvents</code> interface are used for inter-server communication (added in
  <code>socket.io@4.1.0</code>):</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">serverSideEmit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"ping"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"ping"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>And finally, the <code>SocketData</code> type is used to type the <code>socket.data</code> attribute (added in
  <code>socket.io@4.4.0</code>):</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connection"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token plain">data</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token plain">name </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"john"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token plain">data</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token plain">age </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">42</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9">
  <div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16">
        <path fill-rule="evenodd"
          d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z">
        </path>
      </svg></span>caution</div>
  <div class="admonitionContent_S0QG">
    <p>These type hints do not replace proper validation/sanitization of the input. As usual, never trust user input.
    </p>
  </div>
</div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="types-for-the-client">Types for the client<a
    href="#types-for-the-client" class="hash-link" aria-label="Direct link to Types for the client"
    title="Direct link to Types for the client">​</a></h2>
<p>On the client side, you can reuse the same <code>ServerToClientEvents</code> and <code>ClientToServerEvents</code>
  interfaces:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword" style="color: rgb(0, 0, 159);">import</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"> io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> Socket </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">from</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"socket.io-client"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// please note that the types are reversed</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> socket</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> Socket</span><span class="token operator" style="color: rgb(57, 58, 52);">&lt;</span><span class="token plain">ServerToClientEvents</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> ClientToServerEvents</span><span class="token operator" style="color: rgb(57, 58, 52);">&gt;</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>Similarly, the events declared in the <code>ClientToServerEvents</code> interface are used when sending events:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>And the ones declared in <code>ServerToClientEvents</code> are used when receiving events:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"noArg"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"basicEmit"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">a</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> b</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> c</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// a is inferred as number, b as string and c as buffer</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"withAck"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">d</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> callback</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// d is inferred as string and callback as a function that takes a number as argument</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="custom-types-for-each-namespace">Custom types for each
  namespace<a href="#custom-types-for-each-namespace" class="hash-link"
    aria-label="Direct link to Custom types for each namespace"
    title="Direct link to Custom types for each namespace">​</a></h2>
<p>Since each <a href="/docs/v4/namespaces/">Namespace</a> can have its own set of events, you can also provide some
  types for
  each one of them:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword" style="color: rgb(0, 0, 159);">import</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"> Server </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">from</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"socket.io"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// types for the main namespace</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> io </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">new</span><span class="token plain"> </span><span class="token class-name">Server</span><span class="token class-name operator" style="color: rgb(57, 58, 52);">&lt;</span><span class="token class-name">ClientToServerEvents</span><span class="token class-name punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token class-name"> ServerToClientEvents</span><span class="token class-name punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token class-name"> InterServerEvents</span><span class="token class-name punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token class-name"> SocketData</span><span class="token class-name operator" style="color: rgb(57, 58, 52);">&gt;</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// types for the namespace named "/my-namespace"</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">interface</span><span class="token plain"> </span><span class="token class-name">NamespaceSpecificClientToServerEvents</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token function-variable function" style="color: rgb(215, 58, 73);">foo</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">arg</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">void</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">interface</span><span class="token plain"> </span><span class="token class-name">NamespaceSpecificServerToClientEvents</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token function-variable function" style="color: rgb(215, 58, 73);">bar</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">arg</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">void</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">interface</span><span class="token plain"> </span><span class="token class-name">NamespaceSpecificInterServerEvents</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">interface</span><span class="token plain"> </span><span class="token class-name">NamespaceSpecificSocketData</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> myNamespace</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> Namespace</span><span class="token operator" style="color: rgb(57, 58, 52);">&lt;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  NamespaceSpecificClientToServerEvents</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  NamespaceSpecificServerToClientEvents</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  NamespaceSpecificInterServerEvents</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  NamespaceSpecificSocketData</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token operator" style="color: rgb(57, 58, 52);">&gt;</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">of</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"/my-namespace"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">myNamespace</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connection"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"foo"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"bar"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"123"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<p>And on the client side:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword" style="color: rgb(0, 0, 159);">import</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"> io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> Socket </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">from</span><span class="token plain"> </span><span class="token string" style="color: rgb(227, 17, 108);">"socket.io-client"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> socket</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> Socket</span><span class="token operator" style="color: rgb(57, 58, 52);">&lt;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  NamespaceSpecificServerToClientEvents</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  NamespaceSpecificClientToServerEvents</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token operator" style="color: rgb(57, 58, 52);">&gt;</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"/my-namespace"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"bar"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token builtin">console</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">log</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"> </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// "123"</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy"
        class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
            viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="emitting-with-a-timeout">Emitting with a timeout<a
    href="#emitting-with-a-timeout" class="hash-link" aria-label="Direct link to Emitting with a timeout"
    title="Direct link to Emitting with a timeout">​</a></h2>
<p>Emitting with a timeout breaks the symmetry between the sender and the receiver, because the sender has an additional
  error argument in case of failure.</p>
<p>This can be fixed with a little helper type:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block"
  style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
  <div class="codeBlockContent_biex">
    <pre tabindex="0"
      class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token keyword" style="color: rgb(0, 0, 159);">type</span><span class="token plain"> </span><span class="token class-name">WithTimeoutAck</span><span class="token class-name operator" style="color: rgb(57, 58, 52);">&lt;</span><span class="token class-name">isSender </span><span class="token class-name keyword" style="color: rgb(0, 0, 159);">extends</span><span class="token class-name"> </span><span class="token class-name builtin">boolean</span><span class="token class-name punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token class-name"> args </span><span class="token class-name keyword" style="color: rgb(0, 0, 159);">extends</span><span class="token class-name"> </span><span class="token class-name builtin">any</span><span class="token class-name punctuation" style="color: rgb(57, 58, 52);">[</span><span class="token class-name punctuation" style="color: rgb(57, 58, 52);">]</span><span class="token class-name operator" style="color: rgb(57, 58, 52);">&gt;</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> isSender </span><span class="token keyword" style="color: rgb(0, 0, 159);">extends</span><span class="token plain"> </span><span class="token class-name boolean" style="color: rgb(54, 172, 170);">true</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">?</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">[</span><span class="token plain">Error</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">...</span><span class="token plain">args</span><span class="token punctuation" style="color: rgb(57, 58, 52);">]</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> args</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">interface</span><span class="token plain"> </span><span class="token class-name">ClientToServerEvents</span><span class="token class-name operator" style="color: rgb(57, 58, 52);">&lt;</span><span class="token class-name">isSender </span><span class="token class-name keyword" style="color: rgb(0, 0, 159);">extends</span><span class="token class-name"> </span><span class="token class-name builtin">boolean</span><span class="token class-name"> </span><span class="token class-name operator" style="color: rgb(57, 58, 52);">=</span><span class="token class-name"> </span><span class="token class-name boolean" style="color: rgb(54, 172, 170);">false</span><span class="token class-name operator" style="color: rgb(57, 58, 52);">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token function-variable function" style="color: rgb(215, 58, 73);">hello</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">arg</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token function-variable function" style="color: rgb(215, 58, 73);">callback</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token operator" style="color: rgb(57, 58, 52);">...</span><span class="token plain">args</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> WithTimeoutAck</span><span class="token operator" style="color: rgb(57, 58, 52);">&lt;</span><span class="token plain">isSender</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">[</span><span class="token builtin">string</span><span class="token punctuation" style="color: rgb(57, 58, 52);">]</span><span class="token operator" style="color: rgb(57, 58, 52);">&gt;</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">void</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">void</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">interface</span><span class="token plain"> </span><span class="token class-name">ServerToClientEvents</span><span class="token class-name operator" style="color: rgb(57, 58, 52);">&lt;</span><span class="token class-name">isSender </span><span class="token class-name keyword" style="color: rgb(0, 0, 159);">extends</span><span class="token class-name"> </span><span class="token class-name builtin">boolean</span><span class="token class-name"> </span><span class="token class-name operator" style="color: rgb(57, 58, 52);">=</span><span class="token class-name"> </span><span class="token class-name boolean" style="color: rgb(54, 172, 170);">false</span><span class="token class-name operator" style="color: rgb(57, 58, 52);">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> io </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(0, 0, 159);">new</span><span class="token plain"> </span><span class="token class-name">Server</span><span class="token class-name operator" style="color: rgb(57, 58, 52);">&lt;</span><span class="token class-name">ClientToServerEvents</span><span class="token class-name punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token class-name"> ServerToClientEvents</span><span class="token class-name operator" style="color: rgb(57, 58, 52);">&lt;</span><span class="token class-name boolean" style="color: rgb(54, 172, 170);">true</span><span class="token class-name operator" style="color: rgb(57, 58, 52);">&gt;&gt;</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token number" style="color: rgb(54, 172, 170);">3000</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connection"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> cb</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// arg is properly inferred as a number</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token function" style="color: rgb(215, 58, 73);">cb</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"456"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> socket</span><span class="token operator" style="color: rgb(57, 58, 52);">:</span><span class="token plain"> Socket</span><span class="token operator" style="color: rgb(57, 58, 52);">&lt;</span><span class="token plain">ServerToClientEvents</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> ClientToServerEvents</span><span class="token operator" style="color: rgb(57, 58, 52);">&lt;</span><span class="token boolean" style="color: rgb(54, 172, 170);">true</span><span class="token operator" style="color: rgb(57, 58, 52);">&gt;&gt;</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(215, 58, 73);">ioc</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"http://localhost:3000"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">timeout</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token number" style="color: rgb(54, 172, 170);">100</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token function" style="color: rgb(215, 58, 73);">emit</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"hello"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">123</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">err</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> arg</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token comment" style="color: rgb(153, 153, 136); font-style: italic;">// arg is properly inferred as a string</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
    <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
        title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor"
            d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
          </path>
        </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span
          class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24">
            <path
              d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
            </path>
          </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
          </svg></span></button></div>
  </div>
</div>
<header>
  <h1>Memory usage</h1>
</header>
<p>The resources consumed by your Socket.IO server will mainly depend on:</p>
<ul class="">
  <li>the number of connected clients</li>
  <li>the number of messages (<a href="/docs/v4/emitting-events/#basic-emit">basic emit</a>, <a
      href="/docs/v4/emitting-events/#acknowledgements">emit with acknowledgement</a> and <a
      href="/docs/v4/broadcasting-events/">broadcast</a>) received and sent per second</li>
</ul>
<div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9">
  <div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16">
        <path fill-rule="evenodd"
          d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z">
        </path>
      </svg></span>info</div>
  <div class="admonitionContent_S0QG">
    <p>The memory usage of the Socket.IO server should scale <strong>linearly</strong> with the number of connected
      clients.</p>
  </div>
</div>
<p>The source code to reproduce the results presented in this page can be found <a
    href="https://github.com/socketio/socket.io-benchmarks" target="_blank" rel="noopener noreferrer">there</a>.</p>
<p>See also:</p>
<ul class="">
  <li><a href="/docs/v4/load-testing/">Load testing</a></li>
  <li><a href="/docs/v4/performance-tuning/">Performance tuning</a></li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="memory-usage-per-websocket-server-implementation">Memory usage
  per WebSocket server implementation<a href="#memory-usage-per-websocket-server-implementation" class="hash-link"
    aria-label="Direct link to Memory usage per WebSocket server implementation"
    title="Direct link to Memory usage per WebSocket server implementation">​</a></h2>
<p>The memory usage of the Socket.IO server heavily depends on the memory usage of the underlying WebSocket server
  implementation.</p>
<p>The chart below displays the memory usage of the Socket.IO server, from 0 up to 10 000 connected clients, with:</p>
<ul class="">
  <li>a Socket.IO server based on the <a href="https://github.com/websockets/ws" target="_blank"
      rel="noopener noreferrer"><code>ws</code></a> package (used by default)</li>
  <li>a Socket.IO server based on the <a href="https://github.com/mmdevries/eiows" target="_blank"
      rel="noopener noreferrer"><code>eiows</code></a> package, a C++ WebSocket server implementation (see <a
      href="/docs/v4/server-installation/#other-websocket-server-implementations">installation steps</a>)</li>
  <li>a Socket.IO server based on the <a href="https://github.com/uNetworking/uWebSockets.js" target="_blank"
      rel="noopener noreferrer"><code>µWebSockets.js</code></a> package, a C++ alternative to the Node.js native HTTP
    server (see <a href="/docs/v4/server-installation/#usage-with-uwebsockets">installation steps</a>)</li>
  <li>a plain WebSocket server based on the <a href="https://github.com/websockets/ws" target="_blank"
      rel="noopener noreferrer"><code>ws</code></a> package</li>
</ul>
<p><img loading="lazy" alt="Chart of the memory usage per WebSocket server implementation"
    src="/assets/images/memory-usage-per-impl-8690d6186a20d6b7977d717e0e388165.png" class="img_ev3q" width="930"
    height="490"></p>
<p>Tested on <code>Ubuntu 20.04.5 LTS</code> with Node.js <code>v16.18.1</code>, with the following package versions:
</p>
<ul class="">
  <li><code>socket.io@4.5.4</code></li>
  <li><code>eiows@3.8.0</code></li>
  <li><code>uWebSockets.js@20.4.0</code></li>
  <li><code>ws@8.2.3</code></li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="memory-usage-over-time">Memory usage over time<a
    href="#memory-usage-over-time" class="hash-link" aria-label="Direct link to Memory usage over time"
    title="Direct link to Memory usage over time">​</a></h2>
<p>The chart below displays the memory usage of the Socket.IO server over time, from 0 up to 10 000 connected clients.
</p>
<p><img loading="lazy" alt="Chart of the memory usage over time"
    src="/assets/images/memory-usage-over-time-8db305207d360220b34a2595cbaa2455.png" class="img_ev3q" width="943"
    height="530"></p>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9">
  <div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16">
        <path fill-rule="evenodd"
          d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z">
        </path>
      </svg></span>note</div>
  <div class="admonitionContent_S0QG">
    <p>For demonstration purposes, we manually call the garbage collector at the end of each wave of clients:</p>
    <div class="language-js codeBlockContainer_Ckt0 theme-code-block"
      style="--prism-color: #393A34; --prism-background-color: #f6f8fa;">
      <div class="codeBlockContent_biex">
        <pre tabindex="0"
          class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"connection"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token parameter">socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  socket</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">on</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"disconnect"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">,</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: rgb(57, 58, 52);">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(0, 0, 159);">const</span><span class="token plain"> lastToDisconnect </span><span class="token operator" style="color: rgb(57, 58, 52);">=</span><span class="token plain"> io</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token method function property-access" style="color: rgb(215, 58, 73);">of</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token string" style="color: rgb(227, 17, 108);">"/"</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">sockets</span><span class="token punctuation" style="color: rgb(57, 58, 52);">.</span><span class="token property-access">size</span><span class="token plain"> </span><span class="token operator" style="color: rgb(57, 58, 52);">===</span><span class="token plain"> </span><span class="token number" style="color: rgb(54, 172, 170);">0</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token keyword control-flow" style="color: rgb(0, 0, 159);">if</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token plain">lastToDisconnect</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(57, 58, 52);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">      </span><span class="token function" style="color: rgb(215, 58, 73);">gc</span><span class="token punctuation" style="color: rgb(57, 58, 52);">(</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(57, 58, 52);">}</span><span class="token punctuation" style="color: rgb(57, 58, 52);">)</span><span class="token punctuation" style="color: rgb(57, 58, 52);">;</span><br></span></code></pre>
        <div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap"
            title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true">
              <path fill="currentColor"
                d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z">
              </path>
            </svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy"
            class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N"
                viewBox="0 0 24 24">
                <path
                  d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
                </path>
              </svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24">
                <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path>
              </svg></span></button></div>
      </div>
    </div>
    <p>Which explains the clean drop in memory usage when the last client disconnects. This is not needed in your
      application, the garbage collection will be automatically triggered when necessary.</p>
  </div>
</div>
